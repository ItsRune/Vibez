"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9111],{88770:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Features/Ranking","title":"Ranking","description":"Let\'s be honest, there\'s nothing worse than a potential future worker doing an application and not being automatically ranked by a system, days or even weeks of them spamming the group wall (or discord DMs) begging for their rank.","source":"@site/docs/Features/Ranking.md","sourceDirName":"Features","slug":"/Features/Ranking","permalink":"/Vibez/docs/Features/Ranking","draft":false,"unlisted":false,"editUrl":"https://github.com/ItsRune/Vibez/edit/master/docs/Features/Ranking.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"defaultSidebar","previous":{"title":"Chainable","permalink":"/Vibez/docs/Chainable"},"next":{"title":"Ranking Sticks","permalink":"/Vibez/docs/Features/Sticks"}}');var a=r(74848),s=r(28453);const i={sidebar_position:1},o=void 0,l={},d=[{value:"Usage",id:"usage",level:2},{value:"Promote",id:"promote",level:3},{value:"Demote",id:"demote",level:3},{value:"Fire",id:"fire",level:3},{value:"setRank",id:"setrank",level:3},{value:"What&#39;s this <code>whoCalled</code> parameter?",id:"whats-this-whocalled-parameter",level:2},{value:"How would I use this?",id:"how-would-i-use-this",level:3},{value:"Why isn&#39;t it working?",id:"why-isnt-it-working",level:2},{value:"Examples",id:"examples",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"Let's be honest, there's nothing worse than a potential future worker doing an application and not being automatically ranked by a system, days or even weeks of them spamming the group wall (or discord DMs) begging for their rank.\r\nThis is why we have the ranking API. It allows you to rank workers in game without having to do it manually."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"NOTE"}),": Our ranking api can be used separately from this module, we recommend this if you're building a custom ranking system / application center / rank center.\r\nYou can find the module ",(0,a.jsx)(n.a,{href:"https://create.roblox.com/store/asset/117806589757660/Ranking",children:"here"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"IF"})," you're confused with the type definitons, this is for you:\r\nYou may notice that some parameters are separated by a ",(0,a.jsx)(n.code,{children:"|"})," this is noting that you can use either of these types to fill the parameter. ",(0,a.jsx)("br",{}),"\r\nExamples:"]}),"\n",(0,a.jsx)("b",{children:"userId: number | string | Player"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"1"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:'"ROBLOX"'})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"game.Players.ROBLOX"})}),"\n"]}),"\n",(0,a.jsx)("b",{children:"rank: number | string"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"1"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:'"Worker"'})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"roleId"})}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"/VibezAPI/docs/Features/Ranking#whats-this-whocalled-parameter",children:(0,a.jsx)(n.strong,{children:"whoCalled: (See Below)"})})}),"\n",(0,a.jsx)(n.h3,{id:"promote",children:(0,a.jsx)(n.a,{href:"/VibezAPI/api/VibezAPI#Promote",children:"Promote"})}),"\n",(0,a.jsx)(n.p,{children:"Increments a player's rank by 1."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"userId: number | string | Player"})," ",(0,a.jsx)("br",{}),"\r\n",(0,a.jsx)(n.code,{children:"whoCalled: { userName: string, userId: number }?"})]}),"\n",(0,a.jsxs)(n.p,{children:["Returns: ",(0,a.jsx)(n.a,{href:"/VibezAPI/api/VibezAPI#rankResponse",children:"rankResponse"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'local userName = "ROBLOX"\r\nVibezApi:Promote(userId)\n'})}),"\n",(0,a.jsx)(n.h3,{id:"demote",children:(0,a.jsx)(n.a,{href:"/VibezAPI/api/VibezAPI#Demote",children:"Demote"})}),"\n",(0,a.jsx)(n.p,{children:"Decrements a player's rank by 1."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"userId: number | string | Player"})," ",(0,a.jsx)("br",{}),"\r\n",(0,a.jsx)(n.code,{children:"whoCalled: { userName: string, userId: number }?"})]}),"\n",(0,a.jsxs)(n.p,{children:["Returns: ",(0,a.jsx)(n.a,{href:"/VibezAPI/api/VibezAPI#rankResponse",children:"rankResponse"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'local userName = "ROBLOX"\r\nVibezApi:Demote(userId)\n'})}),"\n",(0,a.jsx)(n.h3,{id:"fire",children:(0,a.jsx)(n.a,{href:"/VibezAPI/api/VibezAPI#Fire",children:"Fire"})}),"\n",(0,a.jsx)(n.p,{children:"Sets a player's rank to the lowest rank."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"userId: number | string | Player"})," ",(0,a.jsx)("br",{}),"\r\n",(0,a.jsx)(n.code,{children:"whoCalled: { userName: string, userId: number }?"})]}),"\n",(0,a.jsxs)(n.p,{children:["Returns: ",(0,a.jsx)(n.a,{href:"/VibezAPI/api/VibezAPI#rankResponse",children:"rankResponse"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'local userName = "ROBLOX"\r\nVibezApi:Fire(userId)\n'})}),"\n",(0,a.jsx)(n.h3,{id:"setrank",children:(0,a.jsx)(n.a,{href:"/VibezAPI/api/VibezAPI#setRank",children:"setRank"})}),"\n",(0,a.jsx)(n.p,{children:"Sets a player's rank to a specific rank."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"userId: number | string | Player"})," ",(0,a.jsx)("br",{}),"\r\n",(0,a.jsx)(n.code,{children:"rank: number | string"})," ",(0,a.jsx)("br",{}),"\r\n",(0,a.jsx)(n.code,{children:"whoCalled: { userName: string, userId: number }?"})]}),"\n",(0,a.jsxs)(n.p,{children:["Returns: ",(0,a.jsx)(n.a,{href:"/VibezAPI/api/VibezAPI#rankResponse",children:"rankResponse"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'local userName = "ROBLOX"\r\nlocal newRank = 2\r\nVibezApi:setRank(1, newRank)\n'})}),"\n",(0,a.jsxs)(n.h2,{id:"whats-this-whocalled-parameter",children:["What's this ",(0,a.jsx)(n.code,{children:"whoCalled"})," parameter?"]}),"\n",(0,a.jsxs)(n.p,{children:["Under the hood of the API, we use the ",(0,a.jsx)(n.code,{children:"whoCalled"})," parameter to generate logs within a Discord channel of the action, who did it, and who was affected. ",(0,a.jsx)(n.strong,{children:"THIS PARAMETER IS OPTIONAL"}),". This is useful for auditing purposes, and to see who's abusing the API. If you supply nothing, the wrapper will automatically supply ",(0,a.jsx)(n.strong,{children:"SYSTEM"})," for the username, and the log generated will look different than with a proper user. If you supply a user's ID and name, the log will look like this:"]}),"\n",(0,a.jsx)("img",{src:"/VibezAPI/rankingExampleWithUser.png"}),"\n",(0,a.jsx)(n.p,{children:"If you supply nothing, the log will look like this:"}),"\n",(0,a.jsx)("img",{src:"/VibezAPI/rankingExampleAutomatic.png"}),"\n",(0,a.jsx)(n.h3,{id:"how-would-i-use-this",children:"How would I use this?"}),"\n",(0,a.jsxs)(n.p,{children:["When issuing a function with the wrapper that has this included, just create a new parameter with the ",(0,a.jsx)(n.code,{children:"userName"})," and ",(0,a.jsx)(n.code,{children:"userId"})," keys, and supply the values. Here's an example:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'VibezApi:Promote(1, { userName = "ltsRune", userId = 107392833 })\n'})}),"\n",(0,a.jsx)(n.h2,{id:"why-isnt-it-working",children:"Why isn't it working?"}),"\n",(0,a.jsx)(n.p,{children:"There's many reasons why the ranking API may fail, maybe your discord bot is offline, or maybe the worker is already ranked to the rank you're trying to rank them to. If you're having issues with the ranking API, please join our discord below and ask for help in the support channel."}),"\n",(0,a.jsx)("iframe",{src:"https://discord.com/widget?id=528920896497516554&theme=dark",width:"350",height:"500",allowtransparency:"true",frameborder:"0",sandbox:"allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"}),"\n",(0,a.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,a.jsxs)(r,{children:[(0,a.jsx)("summary",{children:"AutoRank Points"}),(0,a.jsx)("br",{}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",metastring:'title="ServerScriptService/autoRankPoints.server.lua"',children:'--// Configuration \\\\--\r\nlocal apiKey = "API KEY" -- Vibez\'s API Key\r\nlocal pointRanks = {\r\n\t{ Rank = 2, pointsRequired = 10 }\r\n}\r\n\r\n-- IMPORTANT: Scroll down to line 23 to change the location\r\n-- of a player\'s points!\r\n\r\n--// Services \\\\--\r\nlocal Players = game:GetService("Players")\r\nlocal ReplicatedStorage = game:GetService("ReplicatedStorage")\r\nlocal DataStoreService = game:GetService("DataStoreService")\r\n\r\n--// Variables \\\\--\r\nlocal vibezApi = require(14946453963)(apiKey)\r\nlocal dataStoreToUse = DataStoreService:GetDataStore("pointRanks_" .. game.PlaceId)\r\nlocal userCache = {}\r\n\r\n--// Functions \\\\--\r\nlocal function onPlayerAdded(Player: Player)\r\n\t-- Wherever you\'re keeping your player\'s points, this is where you\'d want to change it.\r\n\tlocal pointStats = Player:WaitForChild("leaderstats", 120):WaitForChild("Points", 120)\r\n\r\n\t-- Don\'t touch below unless you know what you\'re doing.\r\n\tlocal isOk, data, connections, formattedString\r\n\tisOk, data = pcall(dataStoreToUse.GetAsync, dataStoreToUse, tostring(Player.UserId))\r\n\r\n\tif not isOk then\r\n\t\treturn\r\n\tend\r\n\r\n\tdata = data or {}\r\n\tconnections = {}\r\n\r\n\ttable.sort(pointRanks, function(a, b)\r\n\t\treturn a.pointsRequired < b.pointsRequired\r\n\tend)\r\n\r\n\ttable.insert(connections, pointStats:GetPropertyChangedSignal("Value"):Connect(function()\r\n\t\tlocal userGroupData = vibezApi:_getGroupFromUser(vibezApi.GroupId, Player.UserId)\r\n\t\tlocal copiedData = userCache[Player.UserId][2] or {}\r\n\r\n\t\tif not userGroupData or userGroupData.Rank == 0 then\r\n\t\t\treturn\r\n\t\tend\r\n\r\n\t\tfor i = 1, #pointRanks do\r\n\t\t\tlocal data = pointRanks[i]\r\n\r\n\t\t\tif\r\n                table.find(copiedData, data.Rank) ~= nil\r\n                or userGroupData.Rank >= data.Rank\r\n                or pointStats.Value < data.pointsRequired\r\n            then\r\n\t\t\t\tcontinue\r\n\t\t\tend\r\n\r\n\t\t\tif\r\n\t\t\t\tuserGroupData.Rank < data.Rank\r\n\t\t\t\tand pointStats.Value >= data.pointsRequired\r\n\t\t\tthen\r\n\t\t\t\tlocal response = vibezApi:setRank(Player, data.Rank)\r\n\r\n\t\t\t\tif response.success then\r\n\t\t\t\t\ttable.insert(copiedData, data.Rank)\r\n\t\t\t\tend\r\n\t\t\t\tbreak\r\n\t\t\tend\r\n\t\tend\r\n\r\n\t\tuserCache[Player.UserId][2] = copiedData\r\n\tend))\r\n\r\n\tuserCache[Player.UserId] = {connections, data}\r\nend\r\n\r\nlocal function onPlayerLeft(Player: Player, retry: number?)\r\n\tlocal exists = userCache[Player.UserId]\r\n\tif not exists then\r\n\t\treturn\r\n\tend\r\n\r\n\tlocal isOk = pcall(dataStoreToUse.SetAsync, dataStoreToUse, tostring(Player.UserId), exists[2])\r\n\tif not isOk then\r\n\t\tretry = retry or 0\r\n\t\tif retry > 3 then\r\n\t\t\terror("Failed to save data for user " .. Player.Name)\r\n\t\t\treturn\r\n\t\tend\r\n\r\n\t\ttask.wait(3)\r\n\t\treturn onPlayerLeft(Player, retry + 1)\r\n\tend\r\n\r\n\tfor _, connection: RBXScriptConnection in pairs(exists[1]) do\r\n\t\tconnection:Disconnect()\r\n\tend\r\n\r\n\tuserCache[Player.UserId] = nil\r\nend\r\n\r\n--// Events \\\\--\r\nfor _, v in ipairs(Players:GetPlayers()) do\r\n\tcoroutine.wrap(onPlayerAdded)(v)\r\nend\r\n\r\nPlayers.PlayerAdded:Connect(onPlayerAdded)\r\nPlayers.PlayerRemoving:Connect(onPlayerLeft)\n'})})]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>o});var t=r(96540);const a={},s=t.createContext(a);function i(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);